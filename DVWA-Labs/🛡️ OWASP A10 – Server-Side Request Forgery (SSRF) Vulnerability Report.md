# 🛡️ OWASP A10 – Server-Side Request Forgery (SSRF) Vulnerability Report

---

## 🔎 1. Introduction

Server-Side Request Forgery (SSRF) is a critical vulnerability where an attacker tricks a server into making unauthorized requests to internal or external systems.  
This can lead to sensitive data exposure, internal network scanning, and potential further exploitation.

---

## ⚙️ 2. Environment Setup

| Component          | Details                 |
|--------------------|-------------------------|
| Operating System    | Ubuntu/Debian Linux     |
| Web Server         | Apache 2                |
| Language           | PHP                     |
| Vulnerable Script  | `/var/www/html/ssrf.php` |

---

## 📝 3. Vulnerable Code Snippet

```php
<?php
if (isset($_GET['url'])) {
    $url = $_GET['url'];
    // SSRF vulnerability: no validation or filtering on user input
    $response = file_get_contents($url);
    echo "<h2>Response from: $url</h2>";
    echo "<pre>" . htmlspecialchars($response) . "</pre>";
} else {
?>
<form method="GET">
    Enter URL to fetch:<br>
    <input type="text" name="url" size="50" autocomplete="off">
    <input type="submit" value="Fetch">
</form>
<?php
}
?>
```
## 🚀 4. Attack Execution and Results
Tested Payloads:

| Payload | Purpose | Result/Effect |
| --- | --- | --- |
| `http://example.com` | External URL fetch | Displays external website content |
| `http://127.0.0.1/` | Localhost request (internal) | Returns Apache default page (It works!) |
| `file:///etc/passwd` | Attempt to read local file | Typically blocked or error |
| `http://169.254.169.254/latest/meta-data/` | AWS metadata access attempt | Accessible if running on AWS server |

![SC1](Screenshots/SC1.png)

![SS21](Screenshots/SS21.png)

![SS31](Screenshots/SS31.png)

## 🛡️ 6. Mitigation Recommendations

To prevent SSRF vulnerabilities, consider the following security best practices:

* ✅ **Input Validation:** Whitelist allowed domains and URLs strictly
* ✅ **Disable URL fopen wrappers:** Disable `allow_url_fopen` if not needed
* ✅ **Network Segmentation:** Restrict server network access to sensitive/internal resources
* ✅ **Authentication & Authorization:** Protect internal APIs and services
* ✅ **URL Sanitization:** Normalize and sanitize user input URLs carefully before usage
* ✅ **Use Safe HTTP Clients:** Use libraries that enforce restrictions on outgoing requests

## 📚 7. Conclusion

The SSRF vulnerability demonstrated here allows attackers to force the server to make HTTP requests to unintended destinations, potentially exposing sensitive internal services.

Implementing strict input validation and network controls is critical to secure web applications against SSRF.